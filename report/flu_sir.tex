\documentclass[12pt]{article}

% Tipografiado y preferencias regionales
\usepackage[utf8]{inputenc}
\usepackage[spanish,es-noindentfirst]{babel}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage{csquotes,textcomp,microtype}
\decimalpoint
\unaccentedoperators

% Matemáticas
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsthm}

% Bibliografía
\usepackage[style=numeric]{biblatex}
\addbibresource{ref.bib}

% Formato
\usepackage[hmargin=3cm,vmargin=2.5cm]{geometry}

% Imágenes
\usepackage{tikz}
%\usepackage{graphicx}
%\graphicspath{../figures/}

% Enlaces
\usepackage[pdftex]{hyperref}
%\usepackage[spanish]{cleveref}

% Entornos
\newcommand{\absdiv}[1]{%
  \par\addvspace{.5\baselineskip}% adjust to suit
  \noindent\textbf{#1}\quad\ignorespaces
}

% Comandos
\newcommand{\R}{\mathbb{R}}

\begin{document}
	\title{Estimación}
	\author{Jorge Esteban Mendoza Ortiz (418002863)\thanks{\href{mailto:esteban.mendoza@ciencias.unam.mx}{\nolinkurl{esteban.mendoza@ciencias.unam.mx}}} \\
	Enrique Moctezuma González (315019344)\thanks{\href{mailto:enriquemg@ciencias.unam.mx}{\nolinkurl{enriquemg@ciencias.unam.mx}}}\\
	Ana Victoria López Rodríguez (314614300)\thanks{\href{anaviclopez@ciencias.unam.mx}{\nolinkurl{anaviclopez@ciencias.unam.mx}}}}
	\date{}
	\maketitle
	
	\begin{abstract}
	\absdiv{sub\_abstract}
	\end{abstract}
	
	% Introducción
	\noindent
	
	\section{Materiales y métodos}
	\subsection*{Fuente de datos}
	
	El diseño del estudio fue ecológico. Los datos se obtuvieron del reporte titulado "<Situación actual de la epidemia"> publicado por la Secretaría de Salud de México el 20 de agosto de 2009 \cite{Salud2009}. Se definió como unidad de análisis los casos de influenza A/H1N1 confirmados por el laboratorio del Instituto de Diagnóstico y Referencia Epidemiológicos (InDRE), citados en el reporte antes mencionado. El InDRE es la autoridad que recopiló los casos reportados de esta enfermedad a nivel nacional. Se definió como unidad de análisis de tiempo los días naturales.
	
	Los cálculos presentados se realizaron utilizando el paquete estadístico \texttt{R} versión 3.5.3 y \texttt{Matlab} R2019a Update 5.
	
	
	\subsection*{Descripción del modelo SIR}
	
	El modelo SIR fue desarrollado por Kermack y McKendrick en 1927 \cite{Bacaer2011} y ha sido aplicado en diversos escenarios de epidemias. Este modelo estima el número de personas susceptibles de enfermar (susceptibles), el número de enfermos (infectados) y el número de personas que ya no pueden transmitir la enfermedad ya sea porque se han recuperado y han adquirido inmunidad o porque han fallecido (removidos).
	
	Los supuestos del modelo SIR son: a) la población es homogénea y de tamaño fijo; b) en un momento dado, cada individuo sólo puede pertenecer a uno de los siguientes conjuntos: infectados, susceptibles o removidos; c) la interacción entre los individuos es aleatoria y d) no hay intervención externa que cambie la tasa de contacto de la población. Se asumió que la población del país es constante y que el número de individuos susceptibles $ S(t) $, infectados $ I(t) $ y removidos $ R(t) $ son variables que dependen del tiempo $ t $. 
	
	El modelo SIR consta de un sistema de tres ecuaciones diferenciales:
	\[ \frac{dS}{dt} = -\kappa S I, \qquad \frac{dI}{dt} = \kappa SI - \mu I, \qquad \frac{dR}{dt} = \mu I, \]
	donde $ \kappa $ es la tasa de contagio por unidad de tiempo (día) y $ \mu $ la tasa de recuperación per cápita. Es la fracción de infectados recuperados en un día dado, que se calcula como el recíproco del período infeccioso estimado de la enfermedad y que en este estudio se estableció en tres días \cite{Fielding2014}.
	
	En términos informales podemos interpretar el modelo SIR como sigue: el cambio del número de susceptibles respecto al tiempo es inversamente proporcional a los contactos entre susceptibles e infectados; el cambio del número de infectados respecto al tiempo es directamente proporcional a los contactos entre susceptibles e infectados además de que el número se ve afectado por la tasa de recuperación; por último, el cambio del número de removidos respecto al tiempo es directamente proporcional al número de infectados, y estos se recuperan a una tasa fija $ mu $.
	
	\subsection*{Aplicación del modelo}
	
	Dado que uno de los supuestos del modelo es que no hay intervención externa que cambie la tasa de contacto de la población se estimó dos veces el parámetro $ \kappa $ para cada etapa de la primera ola pandémica que se presentó en México. Consideramos la primera etapa del inicio de la epidemia hasta la aplicación de medidas de aislamiento nacional, como la suspensión de actividades escolares (27 de marzo al 26 de abril del 2009). La segunda etapa se consideró después de la suspensión de actividades a nivel nacional y la aplicación de otras medidas para disminuir la tasa de contacto (26 de abril al 14 de mayo del 2009). Se añadió un retraso de tres días a los períodos, suponiendo un período de incubación de la influenza de tres días \cite{Fielding2014}.
	
	Para estimar el parámetro $ \kappa $ en cada uno de los períodos considerados hemos recurrido a métodos numéricos. Para obtener una primera subestimación del parámetro hemos obtenido una solución linealizada de la segunda ecuación del modelo. Esto es: observemos que la segunda ecuación del modelo SIR cumple la siguiente igualdad:
	\[ \frac{dI}{dt} = \kappa SI - \mu I = \mu\left(\frac{\kappa SI}{\mu} - I\right) = \mu\left(\frac{\kappa S}{\mu} - 1\right)I. \]
	Si hacemos $ \beta = \mu\left(\frac{\kappa S}{\mu} - 1\right) $, obtenemos la ecuación diferencial $ \frac{dI}{dt} = \beta I $, cuya solución obtenemos analíticamente, y está dada por: $ I(t) = I_0e^{\beta t} $, con lo que nuestro modelo resultante es:
	\[ I(t) = I_0e^{\beta t} + \varepsilon(t) . \] 
	
	Si ignoramos el término de error y tomamos el logaritmo natural a cada lado de esta última expresión obtenemos la linealización deseada, puesto que:
	\begin{equation*}
	\log I(t) = \log(I_0 e^{\beta t}) = \log I_0 + \beta t.
	\end{equation*}
	Haciendo $ Y = \log I(t) $, $ \alpha = \log I_0 $, obtenemos el modelo lineal: $ Y = \alpha + \beta t + \varepsilon(t) $, que es fácil de calcular aunque subestima los parámetros, puesto que hemos sustituido los términos de error originales por otros términos de error del modelo lineal.
	
	Una vez que obtenemos dichas subestimaciones utilizamos el método de descenso de gradiente para hallar una aproximación numérica a los parámetros $ I_0 $ y $ \beta $ que minimizan la función de costo:
	\[ J(I_0, \beta) = \frac{1}{2n}\sum_{t=0}^{n}\left( I(t) - I_0e^{\beta t} \right)^2, \]
	donde $ n $ es el número de días considerados en cada período menos uno porque el primer día de cada período es el tiempo $ t=0 $.
	
	El método de descenso de gradiente es un método iterativo que actualiza los parámetros $ I_0 $ y $ \beta $ del siguiente modo:
	\[ ({I_0}_{i+1}, \beta_{i+1}):= -\alpha \nabla J({I_0}_i, \beta_i), \]
	donde 
	\begin{align*}
	-\nabla J({I_0}_i, \beta_i) &= -\left( \frac{\partial}{\partial I_0}J({I_0}_i, \beta_i), \frac{\partial}{\partial \beta}J({I_0}_i, \beta_i) \right) \\
	&= -\left(\frac{1}{n}\sum_{t=0}^{n}(I(t) - {I_0}_ie^{\beta_i t})(-e^{\beta_i t}),  \frac{1}{n}\sum_{t=0}^{n}(I(t) - {I_0}_ie^{\beta_i t})(-{I_0}_ite^{\beta_i t}) \right)
	\end{align*}
	es la dirección de máximo descenso de la función de costo dados los parámetros $ (I_0, \beta) $ en la \textit{i}--ésima iteración del método y $ \alpha $ es una "<constante de aprendizaje"> que determina la magnitud del cambio de los parámetros a cada iteración. Para $ \alpha $ suficientemente pequeña el método garantiza converger a un mínimo local.
	
	
	
	\section{Resultados}
	
	\begin{figure}
		\centering
		\input{../figures/comparacion.tex}
		\caption{Sample output from tikzDevice}
		\label{plot:test}
	\end{figure}
	
	\section{Discusión}
	
	\printbibliography[title={Referencias}]
	
\end{document}
